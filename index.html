<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rosetta ‚Äì Don't Learn Music, Play Music</title>
    <meta name="description"
        content="Achieve instant musical fluency through pure instinct. Rosetta bypasses the cognitive bottleneck of traditional notation.">
    <script>
        // Initialize theme before DOM renders to prevent flash
        (function() {
            const stored = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const isDark = stored ? stored === 'dark' : prefersDark;
            if (isDark) {
                document.documentElement.classList.add('dark-mode');
            } else {
                document.documentElement.classList.add('light-mode');
            }
        })();
    </script>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; background: #0f0f0f; color: #fff; margin: 0; padding: 0; }
        header { padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        h1 { font-size: 2.5rem; margin: 1rem 0; }
    </style>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet" media="print" onload="this.media='all'">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
            rel="stylesheet">
    </noscript>

    <link rel="stylesheet" href="style.css" media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="style.css">
    </noscript>
</head>

<body>

    <!-- Header -->
    <header>
        <a href="#" class="logo">ROSETTA<span>.</span></a>
        <nav>
            <ul>
                <li><a href="#method">Method</a></li>
                <li><a href="#software">Software</a></li>
                <li><a href="#hardware">Hardware</a></li>
                <!-- <li><a href="#search">Find Music</a></li> -->
                <li><a href="manifesto.html">Manifesto</a></li>
            </ul>
        </nav>
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="Toggle theme">
            <span id="themeIcon">üåô</span>
        </button>
        <button class="header-cta" onclick="openModal('download-modal')">Get Updates</button>
    </header>

    <!-- Hero Section -->
    <section class="hero reveal">
        <div class="hero-bg"></div>
        <h1>
            <span class="gradient-text reveal" data-delay="200">Rosetta</span>
            <span class="hero-subtitle reveal" data-delay="400">Don't learn music, PLAY music</span>
        </h1>
        <p class="hero-subtext reveal" data-delay="600">Bypass the cognitive bottleneck. Achieve instant motor-skill
            acquisition through visual-spatial flow and neuroplasticity.</p>
        <div class="btn-group reveal" data-delay="800">
            <a href="#download" class="btn btn-primary" onclick="openModal('download-modal')">Download Free Beta</a>
            <a href="#hardware" class="btn btn-secondary">Explore Hardware</a>
        </div>
    </section>

    <!-- Neuroscience Section -->
    <section id="neuroscience" class="reveal">
        <div class="bg-blob blob-1"></div>
        <div class="bg-blob blob-2"></div>
        <div class="section-glass-wrap">
            <div class="content-block">
                <div class="image-container">
                    <img src="neuroscience_brain_flow_graphic_1767483894051.png" alt="Neuroscience of Musical Flow" width="1024" height="1024" loading="lazy" decoding="async">
                </div>
                <div class="text-container reveal" data-delay="400">
                    <h2>The Neuroscience of Flow</h2>
                    <p>Rosetta isn't just a tool; it's a neurobiological intervention. We leverage the brain's natural
                        capacity for <strong>Long-Term Potentiation (LTP)</strong> to hardwire musical skill directly
                        into
                        procedural memory.</p>
                    <ul class="feature-list">
                        <li><strong>Visual-Spatial Mapping:</strong> Stimuli align physically with action, eliminating
                            translation lag.</li>
                        <li><strong>Cognitive Bypass:</strong> Bypassing the prefrontal cortex to activate instinctive
                            motor
                            centers.</li>
                        <li><strong>Rapid Myelination:</strong> Accelerated neural pathway strengthening through
                            gamified,
                            high-frequency play.</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Detailed Method -->
    <section id="method" class="reveal">
        <div class="bg-blob blob-1"
            style="background: radial-gradient(circle, rgba(56, 189, 248, 0.15) 0%, transparent 70%);"></div>
        <div class="section-glass-wrap">
            <div class="section-header">
                <h2>The Rosetta Method</h2>
                <p>A hi-tech approach to motor skill acquisition based on decades of cognitive research.</p>
            </div>

            <div class="card-grid">
                <div class="card reveal" data-delay="100">
                    <div class="card-icon">üß†</div>
                    <h3>The Bottleneck</h3>
                    <p>Traditional notation requires: Read ‚Üí Decode ‚Üí Locate ‚Üí Play. This 4-step process creates 90%
                        cognitive friction.</p>
                </div>
                <div class="card reveal" data-delay="200">
                    <div class="card-icon">‚ö°</div>
                    <h3>The Impulse</h3>
                    <p>Rosetta collapses these steps into one: <strong>See + Play</strong>. Your brain processes falling
                        lights as instinctive physical events.</p>
                </div>
                <div class="card reveal" data-delay="300">
                    <div class="card-icon">üöÄ</div>
                    <h3>The Result</h3>
                    <p>Play complex compositions from day one. Build permanent neural pathways through pure, gamified
                        joy.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Software Section -->
    <section id="software" class="reveal">
        <div class="bg-blob blob-2" style="left: -100px; top: 0; opacity: 0.3;"></div>
        <div class="section-glass-wrap">
            <div class="content-block">
                <div class="text-container reveal" data-delay="200">
                    <h3>Rosetta PNO</h3>
                    <p>Our fully gamified learning suite designed for rapid motor skill acquisition. High-performance,
                        low-latency, and community-driven.</p>
                    <ul class="feature-list">
                        <li>Proprietary low-latency visual engine</li>
                        <li>Intelligent MIDI pattern recognition</li>
                        <li>Gamified progress tracking & neural feedback</li>
                    </ul>
                    <button class="btn btn-primary" onclick="openModal('download-modal')">Download for macOS / Win /
                        Linux</button>
                </div>
                <div class="image-container">
                    <img src="rosetta_pno_software_ui_1767170970478.png" alt="Rosetta PNO Software Interface" width="1024" height="1024" loading="lazy" decoding="async">
                </div>
            </div>
        </div>
    </section>

    <!-- Hardware Section -->
    <section id="hardware" class="reveal">
        <div class="bg-blob blob-1" style="right: -100px; bottom: 0; left: auto; opacity: 0.3;"></div>
        <div class="section-glass-wrap">
            <div class="content-block reverse">
                <div class="text-container reveal" data-delay="200">
                    <h3>Rosetta Artifact</h3>
                    <p>The convergence of material truth and hi-tech engineering. A piece of fine furniture as much as a
                        revolutionary instrument.</p>
                    <ul class="feature-list">
                        <li>Zero-parallax integrated OLED console</li>
                        <li>Ultra-precise light-guided key registration</li>
                        <li>Sustainably sourced Walnut & Mahogany chassis</li>
                    </ul>
                    <a href="#" class="btn btn-secondary" onclick="alert('Pre-orders opening soon!')">Pre-Order Limited
                        Batch</a>
                </div>
                <div class="image-container">
                    <img src="acoustica_digitalis_premium_1767170955585.png" alt="Rosetta Artifact Hardware" width="1024" height="1024" loading="lazy" decoding="async">
                </div>
            </div>
        </div>
    </section>

    <!-- Find Music Section - temporarily hidden to improve navigation/scroll performance -->
    <section id="search" style="display:none;" aria-hidden="true">
        <!-- Search section was removed from public view pending redesign. -->
    </section>

    <!-- Community Section -->
    <section id="community">
        <div class="bg-blob blob-1" style="top: 20%; left: 50%; transform: translateX(-50%); opacity: 0.15;"></div>
        <div class="section-glass-wrap">
            <div class="section-header">
                <h2>Apollotopia</h2>
                <p>A harmonic society of creators dedicated to a more resonant world.</p>
            </div>
            <div style="text-align: center; max-width: 800px; margin: 0 auto;">
                <p style="font-size: 20px; margin-bottom: 40px; color: var(--text-primary);">Apollotopia is the
                    socio-economic engine behind Rosetta.
                    We've transitioned from a tech company to a harmonic society. Access is democratized, and support is
                    voluntary.</p>
                <a href="manifesto.html" class="btn btn-secondary">Read the Manifesto</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer style="padding: 80px 5%; border-top: 1px solid var(--glass-border); text-align: center;">
        <div style="margin-bottom: 40px;">
            <a href="#" class="logo" style="justify-content: center; margin-bottom: 20px;">ROSETTA<span>.</span></a>
            <p>¬© 2025 Rosetta Project. All rights reserved.</p>
        </div>
        <nav style="margin-bottom: 40px;">
            <ul style="justify-content: center; gap: 30px;">
                <li><a href="legal.html">Privacy</a></li>
                <li><a href="legal.html">Terms</a></li>
                <li><a href="legal.html">Refunds</a></li>
                <li><a href="mailto:hello@rosetta.fun">Contact</a></li>
            </ul>
        </nav>
        <p style="font-size: 12px; color: var(--text-tertiary);">Designed with ‚ô• by Muse icOn</p>
    </footer>

    <!-- Download Modal -->
    <div id="download-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('download-modal')">&times;</button>
            <h2 style="margin-bottom: 20px; color: var(--accent-light);">Download Rosetta Beta</h2>
            <p style="margin-bottom: 30px;">Rosetta PNO is free and open-source. Help us fuel the mission with a
                voluntary donation.</p>

            <div style="display: grid; gap: 15px; margin-bottom: 30px;">
                <button class="btn btn-secondary" style="text-align: left; padding: 20px;">
                    <strong style="color: var(--accent-light);">$10</strong> ‚Äî Supporter
                </button>
                <button class="btn btn-secondary" style="text-align: left; padding: 20px;">
                    <strong style="color: var(--accent-light);">$25</strong> ‚Äî Visionary
                </button>
                <button class="btn btn-secondary" style="text-align: left; padding: 20px;">
                    <strong style="color: var(--accent-light);">$50+</strong> ‚Äî Founder
                </button>
            </div>

            <button class="btn btn-primary" style="width: 100%;">Continue to Download</button>
        </div>
    </div>

    <script>
        // Modal Logic
        function openModal(id) {
            document.getElementById(id).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        window.onclick = function (event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }

        // Reveal Animations
        const observerOptions = {
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

        // Search Engine Logic - disabled unless search inputs are present
        if (document.getElementById('search-input')) {
            const API_BASE = 'https://tahar-immouni--rosetta-midi-search-web-app.modal.run';
            const searchInput = document.getElementById('search-input');
            const resultsContainer = document.getElementById('search-results');
            const loadingIndicator = document.getElementById('search-loading');
            const emptyIndicator = document.getElementById('search-empty');
            const autocompleteBox = document.getElementById('autocomplete-results');
            const filterBtns = document.querySelectorAll('.filter-btn');

            let activeFilters = {
                difficulty: [],
                genre: [],
                period: []
            };

            let searchTimeout;

            // Enter key support
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    clearTimeout(searchTimeout);
                    autocompleteBox.style.display = 'none';
                    performSearch(searchInput.value);
                }
            });

            searchInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                const query = e.target.value.trim();

                if (query.length < 2) {
                    autocompleteBox.style.display = 'none';
                    return;
                }

                searchTimeout = setTimeout(() => {
                    fetchAutocomplete(query);
                    // Optional: Live search as they type, or wait for Enter?
                    // For now, let's keep live search but with debounce
                    performSearch(query);
                }, 500);
            });
        }

        async function fetchAutocomplete(query) {
            try {
                const res = await fetch(`${API_BASE}/autocomplete?query=${encodeURIComponent(query)}`);
                const data = await res.json();
                renderAutocomplete(data);
            } catch (err) { console.error(err); }
        }

        function renderAutocomplete(items) {
            if (!items.length) {
                autocompleteBox.style.display = 'none';
                return;
            }
            autocompleteBox.innerHTML = items.map(item => `<div class="autocomplete-item">${item}</div>`).join('');
            autocompleteBox.style.display = 'block';

            document.querySelectorAll('.autocomplete-item').forEach(el => {
                el.addEventListener('click', () => {
                    searchInput.value = el.textContent;
                    autocompleteBox.style.display = 'none';
                    performSearch(el.textContent);
                });
            });
        }

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const type = btn.dataset.type;
                const value = btn.dataset.value;

                btn.classList.toggle('active');

                if (activeFilters[type].includes(value)) {
                    activeFilters[type] = activeFilters[type].filter(v => v !== value);
                } else {
                    activeFilters[type].push(value);
                }

                performSearch(searchInput.value);
            });
        });

        async function performSearch(query = "") {
            loadingIndicator.style.display = 'block';
            emptyIndicator.style.display = 'none';
            resultsContainer.innerHTML = '';

            try {
                let url = `${API_BASE}/search?limit=12`;
                if (query) url += `&query=${encodeURIComponent(query)}`;

                // Append all active filters to the URL
                activeFilters.difficulty.forEach(d => url += `&difficulty=${d}`);
                activeFilters.genre.forEach(g => url += `&genre=${g}`);
                activeFilters.period.forEach(p => url += `&period=${p}`);

                const res = await fetch(url);
                const data = await res.json();

                renderResults(data);
            } catch (err) {
                console.error(err);
                loadingIndicator.style.display = 'none';
                resultsContainer.innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: var(--text-tertiary);">Error connecting to neural archives.</div>';
            } finally {
                loadingIndicator.style.display = 'none';
            }
        }

        function renderResults(files) {
            if (!files.length) {
                emptyIndicator.style.display = 'block';
                return;
            }

            resultsContainer.innerHTML = files.map(file => {
                // Determine difficulty tag class
                const diffClass = file.difficulty ? `difficulty-${file.difficulty.toLowerCase()}` : '';
                return `
                <div class="result-card">
                    <div class="result-info">
                        <h3>${file.title}</h3>
                        <p>${file.composer}</p>
                        <div class="result-meta">
                            ${file.difficulty ? `<span class="tag ${diffClass}">${file.difficulty}</span>` : ''}
                            ${file.genre ? `<span class="tag genre">${file.genre}</span>` : ''}
                        </div>
                    </div>
                    <div class="result-actions">
                        <a href="${file.download_url}" target="_blank" class="download-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                            Download
                        </a>
                    </div>
                </div>
            `;
            }).join('');
        }

        // Initial empty search to show featured
        performSearch();
    </script>

    <script>
        // Theme Toggle Functionality
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const htmlElement = document.documentElement;

        function updateThemeIcon() {
            const isDark = htmlElement.classList.contains('dark-mode');
            themeIcon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
        }

        function toggleTheme() {
            const isDark = htmlElement.classList.contains('dark-mode');
            
            if (isDark) {
                htmlElement.classList.remove('dark-mode');
                htmlElement.classList.add('light-mode');
                localStorage.setItem('theme', 'light');
            } else {
                htmlElement.classList.remove('light-mode');
                htmlElement.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
            }
            
            updateThemeIcon();
        }

        themeToggle.addEventListener('click', toggleTheme);
        
        // Set initial icon
        updateThemeIcon();
    </script>
</body>

</html>